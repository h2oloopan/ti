define(["jquery","me","utils","ehbs!templates/tests/tests.index","ehbs!templates/tests/tests.review","ehbs!templates/tests/tests.new"],function(){var t;return t={setup:function(t){return t.Router.map(function(){return this.resource("tests",function(){return this.route("new"),this.route("review")})}),t.TestsIndexRoute=Ember.Route.extend({model:function(){return this.store.find("test")}}),t.TestsIndexController=Ember.ArrayController.extend({sortProperties:["id"],sortAscending:!1,itemController:"testItem"}),t.TestItemController=Ember.ObjectController.extend({downloadPath:function(){return"/api/download/pdfs/"+this.get("id")}.property("model"),actions:{republish:function(t){return t.set("public",!0),t.save().then(function(){return!0},function(t){return alert(t.responseText),!1}),!1},review:function(t){var e,s;return s=t.get("id"),e=[s],this.transitionToRoute("tests.review",{queryParams:{tests:JSON.stringify(e)}}),!1}}}),t.TestsReviewRoute=Ember.Route.extend({queryParams:{tests:{refreshModel:!0,replace:!0}},model:function(t){return this.store.find("test",{ids:t.tests})}}),t.TestsReviewController=Ember.ArrayController.extend({queryParams:["tests"],tabs:function(){var t,e,s,n,r,i,o,u;if(i=this.get("model"),null==i)return[];for(r=[],t=0,s=["A","B","C"],e=o=0,u=i.get("length");u>=0?u>o:o>u;e=u>=0?++o:--o)n={name:"Test "+s[t],id:"t-"+s[t],link:"#t-"+s[t],test:i.content[t],active:!1},n.test.downloadPath="/api/download/pdfs/"+n.test.get("id"),0===t&&(n.active=!0),0===t&&this.send("switch",i.content[t]),r.push(n),t++;return r}.property("model"),actions:{"switch":function(t){return this.set("test",t),this.set("settings",JSON.stringify(t.get("settings"))),!1},save:function(){return!1},publish:function(t){var e,s,n;if(n=this,s=this.get("settings"),null==s)s={};else try{s=JSON.parse(s)}catch(r){return e=r,alert("Invalid setting format, must be JSON"),!1}return t.set("settings",s),t.set("public",!0),t.save().then(function(){return!0},function(t){return alert(t.responseText),!1}),!1}}}),t.QuestionItemView=Ember.View.extend({didInsertElement:function(){var t;return this._super(),t=this.get("element"),MathJax.Hub.Queue(["Typeset",MathJax.Hub,t])}})}}});