// Generated by CoffeeScript 1.7.1
define(['ehbs!templates/components/photo-upload', 'jquery.fileupload'], function() {
  var PhotoUploadComponent;
  return PhotoUploadComponent = Ember.Component.extend({
    didInsertElement: function() {
      var thiz;
      this._super();
      thiz = this;
      this.$('a.btn').click(function() {
        return thiz.$('input').click();
      });
      return this.$('input').fileupload({
        dataType: 'json',
        done: function(e, data) {
          return thiz.send('done', data);
        },
        fail: function(e, data) {
          return thiz.send('fail', data);
        }
      });
    },
    actions: {
      done: function(data) {
        var photos, url;
        url = data.response().result.files[0].url;
        photos = this.get('question.photos');
        if (photos == null) {
          photos = [];
        }
        photos.pushObject(url);
        this.set('question.photos', photos);
        return false;
      },
      fail: function(data) {
        alert('Something was wrong: ' + data.errorThrown);
        return false;
      },
      preview: function(url) {
        this.set('previewLink', url);
        this.$('.modal-photo-preview').modal();
        return false;
      },
      "delete": function(url) {
        var photos;
        photos = this.get('question.photos');
        photos.removeObject(url);
        this.set('question.photos', photos);
        return false;
      }
    }
  });
});
