define(["me","routes/questionsRoute","routes/adminRoute","ehbs!templates/header","ehbs!templates/footer","ehbs!templates/login","ehbs!templates/signup","ehbs!templates/error"],function(e,t,o){var r;return r={start:function(){var r;return r=Ember.Application.create(),e.attach(r,["User","Question","School"]),r.Router.map(function(){return this.route("login"),this.route("signup"),this.route("error",{path:"/error/:type"})}),t.setup(r),o.setup(r),r.ApplicationRoute=Ember.Route.extend({model:function(){return e.auth.check()},actions:{logout:function(){var t;return t=this,e.auth.logout().then(function(){return t.store.unloadAll("user"),t.store.unloadAll("school"),t.store.unloadAll("question"),t.controllerFor("application").set("model",{}),t.transitionTo("index")},function(){return!1}),!1}}}),r.ApplicationController=Ember.ObjectController.extend({isAdmin:function(){var e;return e=this.get("model.power"),e>=999?!0:!1}.property("model.power")}),r.IndexRoute=Ember.Route.extend({beforeModel:function(){var t;return t=this,e.auth.check().then(function(e){return t.transitionTo(null!=e?"questions":"login")},function(){return t.transitionTo("login")})}}),r.LoginRoute=Ember.Route.extend({model:function(){return this.store.createRecord("user",{})}}),r.LoginController=Ember.ObjectController.extend({error:null,needs:"application",actions:{login:function(){var t,o;return o=this,this.set("error",null),(t=this.get("model").validate(["username","password"]))?(e.auth.login(this.get("model")).then(function(e){return o.set("controllers.application.model",e),o.transitionToRoute("questions")},function(e){return o.set("error",e),!1}),!1):!1}}}),r.ErrorController=Ember.ObjectController.extend({message:function(){switch(this.get("type")){case"401":return"You do not have the permission to access the requested resource!";default:return"Something went wrong!"}}.property("type")})}}});